<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secret Message - Ù…ÙˆÙ‚Ø¹Ùƒ Ø§Ù„Ø®Ø§Øµ</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --pink: #ff2d55; --bg: #0d0d0d; --card-bg: #1a1a1a; }
        body { margin: 0; background: var(--bg); color: white; font-family: 'Cairo', sans-serif; text-align: center; }
        
        /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ù‚Ù„ÙˆØ¨ Ø§Ù„Ù…ØªØ³Ø§Ù‚Ø·Ø© */
        #hearts-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 10; }

        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        .header { padding: 50px 20px; border-bottom: 2px solid #222; }
        .header h1 { color: var(--pink); font-size: 2.8rem; margin: 0; text-shadow: 0 0 10px rgba(255,45,85,0.4); }

        /* Ø§Ù„ÙƒØ±ÙˆØª */
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; padding: 20px; max-width: 450px; margin: auto; }
        .card { background: var(--card-bg); border: 1px solid #333; border-radius: 20px; padding: 25px 10px; cursor: pointer; transition: 0.3s; }
        .card:hover { border-color: var(--pink); transform: translateY(-5px); }
        .card i { font-size: 40px; display: block; margin-bottom: 10px; }

        /* Ø§Ù„ÙÙˆØ±Ù… */
        .form-section { display: none; padding: 20px; max-width: 400px; margin: auto; }
        input { width: 100%; padding: 15px; margin: 10px 0; border-radius: 12px; border: 1px solid #333; background: #111; color: white; font-family: 'Cairo'; box-sizing: border-box; }
        .btn { background: var(--pink); color: white; border: none; padding: 15px; width: 100%; border-radius: 12px; font-weight: bold; cursor: pointer; font-size: 1.1rem; }

        /* Ø´Ø§Ø´Ø© Ø§Ù„Ø¹Ø±Ø¶ (Ø§Ù„Ù…Ø³ØªÙ„Ù…) */
        #viewer { display: none; padding: 50px 20px; }
        .gift-box { border: 2px solid var(--pink); border-radius: 25px; padding: 30px; background: rgba(20,20,20,0.8); backdrop-filter: blur(10px); }
        .user-img { width: 100px; height: 100px; border-radius: 50%; border: 3px solid var(--pink); margin-bottom: 15px; }
        
        /* Ù…Ø´ØºÙ„ Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ (Ù…Ø®ÙÙŠ) */
        #bg-music { display: none; }
    </style>
</head>
<body>

    <canvas id="hearts-canvas"></canvas>

    <div id="creator-ui">
        <div class="header">
            <h1>SecretPage</h1>
            <p>ØµÙ…Ù… Ù‡Ø¯ÙŠØªÙƒ ÙˆØ£Ø¶Ù ØµÙˆØ±Ùƒ ÙˆÙ…ÙˆØ³ÙŠÙ‚Ø§Ùƒ</p>
        </div>
        <div class="grid">
            <div class="card" onclick="setup('Ù…Ø±ØªØ¨Ø·ÙŠÙ†','ğŸ’–')"><i>ğŸ’–</i><span>Ù…Ø±ØªØ¨Ø·ÙŠÙ†</span></div>
            <div class="card" onclick="setup('Ù…Ø®Ø·ÙˆØ¨ÙŠÙ†','ğŸ’')"><i>ğŸ’</i><span>Ù…Ø®Ø·ÙˆØ¨ÙŠÙ†</span></div>
            <div class="card" onclick="setup('Ø¹ÙŠØ¯ Ù…ÙŠÙ„Ø§Ø¯','ğŸ‚')"><i>ğŸ‚</i><span>Ø¹ÙŠØ¯ Ù…ÙŠÙ„Ø§Ø¯</span></div>
            <div class="card" onclick="setup('Ø§Ø¹ØªØ°Ø§Ø±','ğŸ¥º')"><i>ğŸ¥º</i><span>Ø§Ø¹ØªØ°Ø§Ø±</span></div>
        </div>

        <div id="setup-form" class="form-section">
            <input type="text" id="name" placeholder="Ø§Ø³Ù…Ùƒ">
            <input type="text" id="img-url" placeholder="Ø±Ø§Ø¨Ø· ØµÙˆØ±ØªÙƒ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
            <input type="text" id="music-url" placeholder="Ø±Ø§Ø¨Ø· Ø£ØºÙ†ÙŠØ© (MP3)">
            <input type="password" id="pass" placeholder="ÙƒÙ„Ù…Ø© Ø³Ø± Ù„ÙØªØ­ Ø§Ù„Ø±Ø³Ø§Ù„Ø©">
            <textarea id="msg" placeholder="Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø³Ø±ÙŠØ©..." style="width:100%; height:100px; background:#111; color:white; border:1px solid #333; border-radius:12px; padding:10px; font-family:'Cairo'"></textarea>
            <button class="btn" onclick="build()">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</button>
            <div id="output" style="display:none; margin-top:20px; word-break:break-all; background:#222; padding:10px; border-radius:10px;"></div>
        </div>
    </div>

    <div id="viewer">
        <div id="lock-screen">
            <div style="font-size: 80px;">ğŸ”’</div>
            <h2>Ù‡Ø°Ù‡ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù…Ø­Ù…ÙŠØ©</h2>
            <input type="password" id="check-pass" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±">
            <button class="btn" onclick="openGift()">ÙØªØ­ Ø§Ù„Ù…ÙØ§Ø¬Ø£Ø© ğŸ</button>
        </div>

        <div id="gift-content" style="display:none" class="gift-box">
            <img id="view-img" class="user-img" src="" style="display:none">
            <h1 id="view-emoji"></h1>
            <h2 id="view-title"></h2>
            <p id="view-msg" style="font-size: 1.4rem; line-height: 1.6;"></p>
            <p style="color:var(--pink)">Ù…Ù†: <span id="view-name"></span></p>
            <audio id="bg-music" loop></audio>
        </div>
    </div>

    <script>
        let selT, selE;
        function setup(t, e) {
            selT = t; selE = e;
            document.querySelector('.grid').style.display = 'none';
            document.getElementById('setup-form').style.display = 'block';
        }

        function build() {
            const n = document.getElementById('name').value;
            const i = document.getElementById('img-url').value;
            const mu = document.getElementById('music-url').value;
            const p = document.getElementById('pass').value;
            const m = document.getElementById('msg').value;

            if(!p || !m) return alert("Ø§Ù„Ø±Ø³Ø§Ù„Ø© ÙˆØ§Ù„Ø¨Ø§Ø³ÙˆØ±Ø¯ Ù…Ø·Ù„ÙˆØ¨ÙŠÙ†!");

            const data = btoa(unescape(encodeURIComponent(JSON.stringify({n,i,mu,p,m,t:selT,e:selE}))));
            const fullUrl = window.location.origin + window.location.pathname + "?id=" + data;
            
            document.getElementById('output').style.display = 'block';
            document.getElementById('output').innerHTML = `Ø§Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·:<br><input value="${fullUrl}" readonly style="width:100%">`;
        }

        const params = new URLSearchParams(window.location.search);
        if(params.has('id')) {
            document.getElementById('creator-ui').style.display = 'none';
            document.getElementById('viewer').style.display = 'block';
        }

        function openGift() {
            const data = JSON.parse(decodeURIComponent(escape(atob(params.get('id')))));
            if(document.getElementById('check-pass').value === data.p) {
                document.getElementById('lock-screen').style.display = 'none';
                document.getElementById('gift-content').style.display = 'block';
                
                document.getElementById('view-emoji').innerText = data.e;
                document.getElementById('view-title').innerText = data.t;
                document.getElementById('view-msg').innerText = data.m;
                document.getElementById('view-name').innerText = data.n;
                
                if(data.i) {
                    document.getElementById('view-img').src = data.i;
                    document.getElementById('view-img').style.display = 'inline-block';
                }
                
                if(data.mu) {
                    const audio = document.getElementById('bg-music');
                    audio.src = data.mu;
                    audio.play();
                }
                
                initHearts();
            } else { alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø®Ø·Ø£!"); }
        }

        function initHearts() {
            const canvas = document.getElementById('hearts-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            const hearts = [];
            for(let i=0; i<70; i++) hearts.push({ x: Math.random()*canvas.width, y: Math.random()*canvas.height, s: Math.random()*3+1 });
            function draw() {
                ctx.clearRect(0,0,canvas.width, canvas.height);
                ctx.fillStyle = '#ff2d55';
                hearts.forEach(h => {
                    ctx.beginPath(); ctx.arc(h.x, h.y, h.s*4, 0, 6.28); ctx.fill();
                    h.y += h.s; if(h.y > canvas.height) h.y = -20;
                });
                requestAnimationFrame(draw);
            }
            draw();
        }
    </script>
</body>
</html>
